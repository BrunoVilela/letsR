a<-read.table("clipboard", sep="\t")
summary(lm(V3~V1+V2, data=a))
summary(lm(V3~V1, data=a))
summary(lm(V3~V2, data=a))
summary(lm(V3~V2+V1, data=a))
#Packages
library(raster)
library(maptools)
library(maps)
library(XML)
library(geosphere)
library(devtools)
library(letsR)
data(Phyllomedusa)
data(Phyllomedusa)
library(letsR)
data(Phyllomedusa)
library(letsR)
data(Phyllomedusa)
data(Phyllomedusa)
data(Phyllomedusa)
data("Phyllomedusa")
x11(width=40, height=15)
par(mfrow=c(1,3), mar=c(2, 4, 4, 2))
plot(Phyllomedusa, col=rainbow(46, alpha=0.5))
map(add=T)
text(labels="A", y=14, x=-78, cex=2)
plot(PAM, axes=FALSE, box=FALSE)
text(labels="B", y=14, x=-78, cex=2)
plot(PAM, name="Phyllomedusa nordestina", axes=FALSE, box=FALSE)
plot(Phyllomedusa[grep("nordestina",Phyllomedusa$binomial), ], add=T, lty=1, lwd=2, border="gray")
points(ponto[PAM$S=="Phyllomedusa nordestina", 2:3], col="gray", pch=20, cex=1.5)
text(labels="C", y=14, x=-78, cex=2)
amphi <- readShapePoly("C:/Users/Bruno/Documents/Spatial data/All_AMPHIBIANS_NOV2013/All_AMPHIBIANS_NOV2013.shp", delete_null_obj=TRUE)
Phyllomedusa <- amphi[grep("Phyllomedusa", amphi$binomial), ]
PAM <- lets.presab(Phyllomedusa, xmn=-80, xmx=-30, ymn= -40, ymx=13, res=0.5, count=T)
ponto <- lets.midpoint(PAM)
ponto <- lets.midpoint(PAM)
x11(width=40, height=15)
par(mfrow=c(1,3), mar=c(2, 4, 4, 2))
plot(Phyllomedusa, col=rainbow(46, alpha=0.5))
map(add=T)
text(labels="A", y=14, x=-78, cex=2)
plot(PAM, axes=FALSE, box=FALSE)
text(labels="B", y=14, x=-78, cex=2)
plot(PAM, name="Phyllomedusa nordestina", axes=FALSE, box=FALSE)
plot(Phyllomedusa[grep("nordestina",Phyllomedusa$binomial), ], add=T, lty=1, lwd=2, border="gray")
points(ponto[PAM$S=="Phyllomedusa nordestina", 2:3], col="gray", pch=20, cex=1.5)
text(labels="C", y=14, x=-78, cex=2)
PAM
summary(PAM)
ponto
tiff(filename = "C:/Users/Bruno/SkyDrive/Pacote/testes/Maps.tif", width = 400, height = 150, compression= "lzw")
x11(width=40, height=15)
par(mfrow=c(1,3), mar=c(2, 4, 4, 2))
plot(Phyllomedusa, col=rainbow(46, alpha=0.5))
map(add=T)
text(labels="A", y=14, x=-78, cex=2)
plot(PAM, axes=FALSE, box=FALSE)
text(labels="B", y=14, x=-78, cex=2)
plot(PAM, name="Phyllomedusa nordestina", axes=FALSE, box=FALSE)
plot(Phyllomedusa[grep("nordestina",Phyllomedusa$binomial), ], add=T, lty=1, lwd=2, border="gray")
points(ponto[PAM$S=="Phyllomedusa nordestina", 2:3], col="gray", pch=20, cex=1.5)
text(labels="C", y=14, x=-78, cex=2)
dev.off()
data(Phyllomedusa)
data(teste)
data(Phyllomedusa.Rdata)
data(Phyllomedusa)
tiff(file = "C:/Users/Bruno/SkyDrive/Pacote/testes/Maps.tiff", width = 400, height = 150, compression= "lzw")
x11(width=40, height=15)
par(mfrow=c(1,3), mar=c(2, 4, 4, 2))
plot(Phyllomedusa, col=rainbow(46, alpha=0.5))
map(add=T)
text(labels="A", y=14, x=-78, cex=2)
plot(PAM, axes=FALSE, box=FALSE)
text(labels="B", y=14, x=-78, cex=2)
plot(PAM, name="Phyllomedusa nordestina", axes=FALSE, box=FALSE)
plot(Phyllomedusa[grep("nordestina",Phyllomedusa$binomial), ], add=T, lty=1, lwd=2, border="gray")
points(ponto[PAM$S=="Phyllomedusa nordestina", 2:3], col="gray", pch=20, cex=1.5)
text(labels="C", y=14, x=-78, cex=2)
dev.off()
save(Phyllomedusa, file="data/Phyllomedusa.rda")
data(Phyllomedusa)
save(PAM, file="data/PAM.rda")
library(letsR)
library(raster)
library(maptools)
library(maps)
library(XML)
library(geosphere)
library(devtools)
library(letsR)
data(Phyllomedusa)
data(PAM)
ponto <- lets.midpoint(PAM)
iucn <- lets.iucn(PAM)
mpl <- lets.maplizer(PAM, iucn$Description_Year, iucn$Species, ras=T)
distanc <- matrix(0, ncol=nrow(ponto), nrow=nrow(ponto))
for(i in 1:nrow(ponto)){
for(j in 1:nrow(ponto)){
distanc[i,j] <- distCosine(ponto[i, 2:3], ponto[j, 2:3])
}
}
x11(width=40, height=15)
par(mfrow=c(1,3), mar=c(2, 4, 4, 2))
plot(Phyllomedusa, col=rainbow(46, alpha=0.5))
map(add=T)
text(labels="A", y=14, x=-78, cex=2)
plot(PAM, axes=FALSE, box=FALSE)
text(labels="B", y=14, x=-78, cex=2)
plot(PAM, name="Phyllomedusa nordestina", axes=FALSE, box=FALSE)
plot(Phyllomedusa[grep("nordestina",Phyllomedusa$binomial), ], add=T, lty=1, lwd=2, border="gray")
points(ponto[PAM$S=="Phyllomedusa nordestina", 2:3], col="gray", pch=20, cex=1.5)
text(labels="C", y=14, x=-78, cex=2)
x11()
plot(mpl$ras, axes=FALSE, box=FALSE)
map(add=T)
x11(width=15, height=30)
par(mfrow=c(2,1), mar=c(4, 4, 4, 4))
plot(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]), cex=1.5, bty="l", pch=20, ylab="Description Year", xlab="Range size")
a <- lowess(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
lines(a, col="red")
a <- lets.correl(iucn$Description_Year, distanc, 10, equidistant=T)
x11(width=20, height=20)
plot(mpl$ras, axes=FALSE, box=FALSE)
map(add=T)
x11(width=20, height=30)
par(mfrow=c(2,1), mar=c(4, 4, 4, 4))
plot(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]), cex=1.5, bty="l", pch=20, ylab="Description Year", xlab="Range size")
a <- lowess(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
lines(a, col="red")
a <- lets.correl(iucn$Description_Year, distanc, 10, equidistant=T)
x11(width=20, height=20)
plot(mpl$ras, axes=FALSE, box=FALSE)
map(add=T)
x11(width=20, height=30)
par(mfrow=c(2,1), mar=c(4, 4, 4, 4))
plot(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]), cex=1.5, bty="l", pch=20, ylab="Description Year", xlab="Range size")
a <- lowess(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
lines(a, col="red")
a <- lets.correl(iucn$Description_Year, distanc, 10, equidistant=T)
cor(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]))
lm(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
summary(lm(iucn$Description_Year~colSums(PAM$P[,-(1:2)])))
plot(lm(iucn$Description_Year~colSums(PAM$P[,-(1:2)])))
plot(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
plot(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]), cex=1.5, bty="l", pch=20, ylab="Description Year", xlab="Range size")
a <- lowess(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
abline(mod)
mod <- lm(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
abline(mod)
abline(mod, col="red")
abline(mod, col="red", lty=2)
plot(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]), cex=1.5, bty="l", pch=20, ylab="Description Year", xlab="Range size")
a <- lowess(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
#lines(a, col="red")
abline(mod, col="red", lty=2)
plot(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]), cex=1.5, bty="l", pch=20, ylab="Description Year", xlab="Range size")
a <- lowess(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
lines(a, col="red")
library(adehabitatHS)
library(raster)
library(maptools)
library(vegan)
library(rgdal)
setwd("C:/Users/Bruno/Documents/Desktop/Daniel")
#Preparing the maps
mundo <- readShapePoly("World_car.shp", repair=T)
mundocon <- readShapePoly("continent.shp", repair=T)
Australia <- mundo[mundo$CNTRY_NAME=="Australia", ]
Eur <- mundocon[mundocon$CONTINENT=="Europe", ]
NorAm <- mundocon[mundocon$CONTINENT=="North America", ]
Ma <- readShapePoly("Africa.shp", repair=T)
#variables
r <- stack(list.files(pattern="\\.bil"))
#pontos
pontos <- read.csv("coord2.csv", header=T, sep=",")[, 2:1]
celulas <- extract(r, pontos, cellnumber=T)
celulas <- celulas[, 1]
#function
comp <- function(celulas, celulas2){
n <- length(celulas2)
numero <- numeric(n)
for(i in 1:n){
numero[i] <- sum(celulas2[i]==celulas)
}
return(numero)
}
#Number of specialization axis
k <- 18
#Europe
r_eur <- extract(r, Eur, cellnumber=T)
r_eur <- do.call(rbind.data.frame, r_eur)
r_eur <- na.exclude(r_eur)
afri <-  extract(r, Ma, cellnumber=T)
afri <- do.call(rbind.data.frame, afri)
afri <- na.exclude(afri)
r_eur <- rbind(r_eur, afri)
pca_eur <- r_eur[, -1]
celulas_eur <- r_eur[, 1]
pr_eur <- comp(celulas, celulas_eur)
pc_eur <- dudi.pca(as.data.frame(pca_eur), scannf = FALSE)
enfa_eur <- enfa(pc_eur, pr_eur, scannf = FALSE)
M1 <- sqrt(sum(enfa_eur$ma^2))/1.96
s1 <- enfa_eur$s[1:k]
S1 <- sqrt(sum(s1^2))/length(s1)
T1 <- 1/S1
hist(enfa_eur)
hist(enfa_eur, scores = FALSE, type = "l")
#Australia
r_aus <- extract(r, Australia, cellnumber=T)
r_aus <- do.call(rbind.data.frame, r_aus)
r_aus <- na.exclude(r_aus)
pca_aus <- r_aus[, -1]
celulas_aus <- r_aus[, 1]
normal_aus <- decostand(pca_aus, "normalize", MARGIN=2)
pr_aus <- comp(celulas, celulas_aus)
pc_aus <- dudi.pca(as.data.frame(normal_aus), scannf = FALSE)
enfa_aus <- enfa(pc_aus, pr_aus, scannf = FALSE)
M2 <- sqrt(sum(enfa_aus$ma^2))/1.96
s2 <- enfa_aus$s[1:k]
S2 <- sqrt(sum(s2^2))/length(s2)
T2 <- 1/S2
hist(enfa_aus)
hist(enfa_aus, scores = FALSE, type = "l")
#NorAm
r_nam <- extract(r, NorAm, cellnumber=T)
r_nam <- do.call(rbind.data.frame, r_nam)
r_nam <- na.exclude(r_nam)
pca_nam <- r_nam[, -1]
celulas_nam <- r_nam[, 1]
normal_nam <- decostand(pca_nam, "normalize", MARGIN=2)
pr_nam <- comp(celulas, celulas_nam)
pc_nam <- dudi.pca(as.data.frame(normal_nam), scannf = FALSE)
enfa_nam <- enfa(pc_nam, pr_nam, scannf = FALSE)
M3 <- sqrt(sum(enfa_nam$ma^2))/1.96
s3 <- enfa_nam$s[1:k]
S3 <- sqrt(sum((s3^2)))/length(s3)
T3 <- 1/S3
hist(enfa_nam)
hist(enfa_nam, scores = FALSE, type = "l")
S1
M1
S3
S2
M2
M3
enfa_nam
enfa_nam$s[1:2]/sum(enfa_nam$s)
enfa_nam$s/sum(enfa_nam$s)
enfa_aus$s/sum(enfa_aus$s)
enfa_eur$s/sum(enfa_eur$s)
a <- lets.correl(iucn$Description_Year, distanc, 10, equidistant=T)
#' Compute correlogram based on Moran's I
#'
#' @author Bruno Vilela, Fabricio Villalobos, Lucas Jardim & Jose Alexandre Diniz-Filho
#'
#' @description Compute Moran's correlogram of a variable using a distance matrix.
#'
#' @usage lets.correl(x, y, z, equidistant=FALSE, plot=TRUE)
#'
#' @param x A single variable in vector format or multiple variables in matrix format (as columns).
#' @param y A distance matrix of class 'matrix'.
#' @param z The number of distance classes to use in the correlogram.
#' @param equidistant Logical, if TRUE the classes will be equidistant. If FALSE the classes will have equal number of observations.
#' @param plot Logical, if TRUE the correlogram will be ploted.
#'
#'
#' @export
lets.correl <- function(x, y, z, equidistant=FALSE, plot=TRUE){
if(is.vector(x)){
return(.br.correlogram(x, y, z, equidistant, plot))
}
if(!is.vector(x)){
n <- ncol(x)
parcial <- list()
for(i in 1:n){
parcial[[i]] <- .br.correlogram(x[, i], y, z, equidistant, plot=FALSE)[, c(1, 3, 5, 6)]
}
media <- apply(simplify2array(parcial), 1:2, mean)
desvio <- apply(simplify2array(parcial), 1:2, sd)
resu <- cbind(media[, 1], desvio[, 1], media[, 2], media[, 3], media[, 4] )
colnames(resu) <- c("Observed", "Standard_Deviation", "Expected_value", "Mean_Distance", "Count")
pos3 <- which(!is.na(media[, 1]))
if(plot==TRUE){
plot(x=resu[pos3, 4], y=resu[pos3, 1], bty="l",
ylab= "Moran's I", xlab= "Distance", type="l",
lty=3, ylim=c(-1.5, 1.5))
abline(h=mean(resu[pos3, 3]))
points(x=resu[pos3, 4], y=resu[pos3, 1], pch=20, cex=1.5)
epsilon = max(resu[pos3, 4])/(14*z)
for(i in 1:nrow(resu)) {
up <- resu[pos3, 1] + resu[pos3, 2]
low <- resu[pos3, 1] - resu[pos3, 2]
segments(resu[pos3, 4], low , resu[pos3, 4], up)
segments(resu[pos3, 4]-epsilon, up , resu[pos3, 4]+epsilon, up)
segments(resu[pos3, 4]-epsilon, low , resu[pos3, 4]+epsilon, low)
}
}
return(resu)
}
}
############
.br.correlogram <- function(x, y, z, equidistant=FALSE, plot=TRUE){
y3 <- y
diag(y3) <- NA
y2 <- y
z2 <- 1/z
if(equidistant==FALSE){
quant <- quantile(y3, probs=seq(0, 1, z2), na.rm = TRUE)
}
if(equidistant==TRUE){
quant <- seq(min(y), max(y), ((max(y)-min(y))/z))
}
quant <- as.vector(quant)
n <- length(quant)
ob <- rep(NA, (n-1))
sd1 <- rep(NA, (n-1))
ex <- rep(NA, (n-1))
dist_cl <- rep(NA, (n-1))
p <- rep(NA, (n-1))
count <- rep(NA, (n-1))
for(i in 1:(n-1)){
if(i>1){
pos <- (y>quant[i] & y<=quant[i+1])
count[i] <- sum(pos)
}
if(i==1){
pos <- (y>=quant[i] & y<=quant[i+1])
count[i] <- sum(pos)
}
dist_cl [i] <- mean(c(quant[i], quant[i+1]))
if(count[i]>0){
y2[pos] <- 1
y2[!pos] <- 0
m <- .br.moran(y2, x)
ob[i] <- m$observed
sd1[i] <- m$sd
ex[i] <- m$expected
dist_cl [i] <- mean(c(quant[i], quant[i+1]))
p[i] <- m$p.value
}
}
resu <- cbind(ob, sd1, ex, p, dist_cl, count)
colnames(resu) <- c("Observed", "Standard_Deviation", "Expected_value", "p_value", "Mean_Distance", "Count")
if(plot==TRUE){
pos3 <- which(!is.na(resu[, 1]))
plot(x=dist_cl[pos3],y=ob[pos3], bty="l",
ylab= "Moran's I", xlab= "Distance", type="l",
lty=3, ylim=c(-1.5, 1.5))
abline(h=mean(ex[pos3]))
points(x=dist_cl[pos3], y=ob[pos3], pch=20, cex=1.5)
epsilon = max(dist_cl[pos3])/(14*z)
for(i in 1:nrow(resu)) {
up <- resu[pos3, 1] + resu[pos3, 2]
low <- resu[pos3, 1] - resu[pos3, 2]
segments(resu[pos3, 5], low , resu[pos3, 5], up)
segments(resu[pos3, 5]-epsilon, up , resu[pos3, 5]+epsilon, up)
segments(resu[pos3, 5]-epsilon, low , resu[pos3, 5]+epsilon, low)
}
}
return(resu)
}
############
.br.moran <- function(w, y){
n <- sum(ifelse(rowSums(w)>0, 1, 0))
z <- y-mean(y)
soma <- n*(sum(w*(z%o%z)))
divi <- sum(w) * sum((z^2))
ob <- soma/divi
es <- -1/(n-1)
S1 <-  0.5 * sum((w + t(w))^2)
S2 <- sum((apply(w, 1, sum) + apply(w, 2, sum))^2)
k <- n*sum(z^4)/((sum(z^2))^2)
s.sq <- sum(w)^2
sdi <- sqrt((n * ((n^2 - 3 * n + 3) * S1 - n * S2 + 3 * s.sq)
- k * (n * (n - 1) * S1 - 2 * n * S2 + 6 * s.sq))/((n - 1) *
(n - 2) * (n - 3) * s.sq) - 1/((n - 1)^2))
pv <- pnorm(ob, mean = es, sd = sdi)
pv <- if (ob <= es)
2 * pv
else 2 * (1 - pv)
return(list("observed"=ob, "expected"=es, "sd"=sdi, "p.value"= pv))
}
a <- lets.correl(iucn$Description_Year, distanc, 10, equidistant=T)
library(letsR)
save(iucn, "data/IUCN.rda")
a
summary(mod)
x11(width=20, height=20)
plot(mpl$ras, axes=FALSE, box=FALSE)
map(add=T)
x11(width=20, height=30)
par(mfrow=c(1,2), mar=c(4, 4, 4, 4))
plot(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]), cex=1.5, bty="l", pch=20, ylab="Description Year", xlab="Range size")
a <- lowess(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
lines(a, col="red")
plot(mpl$ras, axes=FALSE, box=FALSE)
map(add=T)
x11(width=30, height=20)
par(mfrow=c(1,2), mar=c(4, 4, 4, 4))
plot(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]), cex=1.5, bty="l", pch=20, ylab="Description Year", xlab="Range size")
a <- lowess(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
lines(a, col="red")
plot(mpl$ras, axes=FALSE, box=FALSE)
map(add=T)
x11(width=30, height=10)
par(mfrow=c(1,2), mar=c(5, 5, 5, 5))
plot(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]), cex=1.5, bty="l", pch=20, ylab="Description Year", xlab="Range size")
a <- lowess(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
lines(a, col="red")
plot(mpl$ras, axes=FALSE, box=FALSE)
map(add=T)
x11(width=20, height=10)
par(mfrow=c(1,2), mar=c(5, 5, 5, 5))
plot(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]), cex=1.5, bty="l", pch=20, ylab="Description Year", xlab="Range size")
a <- lowess(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
lines(a, col="red")
plot(mpl$ras, axes=FALSE, box=FALSE)
map(add=T)
x11(width=40, height=15)
par(mfrow=c(1,3), mar=c(2, 4, 4, 2))
plot(Phyllomedusa, col=rainbow(46, alpha=0.5))
map(add=T)
text(labels="A", y=14, x=-78, cex=2)
plot(PAM, axes=FALSE, box=FALSE)
text(labels="B", y=14, x=-78, cex=2)
plot(PAM, name="Phyllomedusa nordestina", axes=FALSE, box=FALSE)
plot(Phyllomedusa[grep("nordestina",Phyllomedusa$binomial), ], add=T, lty=1, lwd=2, border="gray")
points(ponto[PAM$S=="Phyllomedusa nordestina", 2:3], col="gray", pch=20, cex=1.5)
text(labels="C", y=14, x=-78, cex=2)
x11(width=20, height=10)
par(mfrow=c(1,2), mar=c(5, 5, 5, 5))
plot(PAM, axes=FALSE, box=FALSE)
plot(mpl$ras, axes=FALSE, box=FALSE)
map(add=T)
a <- lowess(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
plot(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]), cex=1.5, bty="l", pch=20, ylab="Description Year", xlab="Range size")
mpl2 <- lets.maplizer(PAM, colSums(PAM$P[,-(1:2)]), iucn$Species, ras=T)
plot(mpl2$R)
plot(mpl2$ra)
plot(mpl2$ra)
map(add=T)
x11(width=40, height=15)
par(mfrow=c(1,3), mar=c(2, 4, 4, 2))
plot(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]), cex=1.5, bty="l", pch=20, ylab="Description Year", xlab="Range size")
a <- lowess(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
lines(a, col="red")
plot(mpl$ras, axes=FALSE, box=FALSE)
map(add=T)
plot(mpl2$ra, axes=FALSE, box=FALSE)
map(add=T)
x11(width=40, height=15)
par(mfrow=c(1,3), mar=c(5, 4, 4, 5))
plot(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]), cex=1.5, bty="l", pch=20, ylab="Description Year", xlab="Range size")
a <- lowess(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
lines(a, col="red")
plot(mpl$ras, axes=FALSE, box=FALSE)
map(add=T)
plot(mpl2$ra, axes=FALSE, box=FALSE)
map(add=T)
colfunc <- colorRampPalette(c("green", "yellow", "red"))
plot(mpl$ras, axes=FALSE, box=FALSE, col=colfunc(3000))
map(add=T)
x11(width=40, height=15)
par(mfrow=c(1,3), mar=c(5, 4, 4, 5))
plot(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]), cex=1.5, bty="l", pch=20, ylab="Description Year", xlab="Range size")
a <- lowess(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
lines(a, col="red")
plot(mpl$ras, axes=FALSE, box=FALSE, col=colfunc(3000))
map(add=T)
plot(mpl2$ra, axes=FALSE, box=FALSE, col=colfunc(1000))
map(add=T)
x11(width=40, height=15)
par(mfrow=c(1,3), mar=c(5, 4, 4, 5))
plot(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]), cex=1.5, bty="l", pch=20, ylab="Description Year", xlab="Range size")
a <- lowess(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
lines(a, col="red")
plot(mpl$ras, axes=FALSE, box=FALSE, col=colfunc(3000))
map(add=T)
plot(mpl2$ra, axes=FALSE, box=FALSE, col=colfunc(2000))
map(add=T)
x11(width=40, height=15)
par(mfrow=c(1,3), mar=c(5, 5, 5, 5))
plot(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]), cex=1.5, bty="l", pch=20, ylab="Description Year", xlab="Range size")
a <- lowess(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
lines(a, col="red")
plot(mpl$ras, axes=FALSE, box=FALSE, col=colfunc(3000))
map(add=T)
plot(mpl2$ra, axes=FALSE, box=FALSE, col=colfunc(2000))
map(add=T)
x11(width=40, height=15)
par(mfrow=c(1,3), mar=c(6, 6, 6, 6))
plot(y=iucn$Description_Year,x=colSums(PAM$P[,-(1:2)]), cex=1.5, bty="l", pch=20, ylab="Description Year", xlab="Range size")
a <- lowess(iucn$Description_Year~colSums(PAM$P[,-(1:2)]))
lines(a, col="red")
plot(mpl$ras, axes=FALSE, box=FALSE, col=colfunc(3000))
map(add=T)
plot(mpl2$ra, axes=FALSE, box=FALSE, col=colfunc(2000))
map(add=T)
x11(width=40, height=15)
par(mfrow=c(1,3), mar=c(2, 4, 4, 2))
plot(Phyllomedusa, col=rainbow(46, alpha=0.5))
map(add=T)
text(labels="A", y=14, x=-78, cex=2)
plot(PAM, axes=FALSE, box=FALSE)
text(labels="B", y=14, x=-78, cex=2)
plot(PAM, name="Phyllomedusa nordestina", axes=FALSE, box=FALSE)
plot(Phyllomedusa[grep("nordestina",Phyllomedusa$binomial), ], add=T, lty=1, lwd=2, border="gray")
points(ponto[PAM$S=="Phyllomedusa nordestina", 2:3], col="gray", pch=20, cex=1.5)
text(labels="C", y=14, x=-78, cex=2)
